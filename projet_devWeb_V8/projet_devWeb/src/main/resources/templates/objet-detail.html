<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>D√©tail de l‚Äôobjet</title>
    <link rel="stylesheet" th:href="@{/style.css}">
</head>
<body class="bodyGarde">

<div class="headerGarde">
    <h1>üîé D√©tail de l‚Äôobjet</h1>
</div>

<div class="contentGarde">
    <div class="admin-card">
        <h2 th:text="${objet.nom}">Nom</h2>

        <p><strong>Description :</strong> <span th:text="${objet.description}">Description</span></p>
        <p><strong>Salle :</strong> <span th:text="${objet.salle.nom}">Salle</span></p>
        <p><strong>Type :</strong> <span th:text="${objet.type}">Type</span></p>

        <p>
            <strong>√âtat :</strong>
            <span th:if="${objet.actif}" style="color: green;">‚úÖ Activ√©</span>
            <span th:unless="${objet.actif}" style="color: red;">‚õî D√©sactiv√©</span>
        </p>

        <!-- ‚úÖ Gestion de l‚Äô√©tat selon utilisateur connect√© -->
        <div th:if="${#authorization.expression('isAuthenticated()')}">
            <form th:action="@{'/Objets/' + ${objet.id} + '/etat'}" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        
                <div th:if="${objet.actif}">
                    <div th:if="${objet.utilisateurActivant != null and objet.utilisateurActivant.email == #authentication.name}">
                        <input type="hidden" name="actif" value="false" />
                        <button type="submit" class="connect-btn">‚ùå D√©sactiver</button>
                    </div>
                    <p th:unless="${objet.utilisateurActivant != null and objet.utilisateurActivant.email == #authentication.name}" style="font-style: italic;">
                        Cet objet est activ√© par un autre utilisateur.
                    </p>
                </div>
        
                <div th:if="${!objet.actif}">
                    <input type="hidden" name="actif" value="true" />
                    <button type="submit" class="connect-btn">‚ö° Activer</button>
                </div>
            </form>
        </div>

        <!-- ‚úÖ Bouton modifier pour les utilisateurs AVANCE -->
        <div th:if="${#authorization.expression('hasAuthority(''AVANCE'')')}">
            <a th:href="@{'/Objets/' + ${objet.id} + '/modifier'}" class="connect-btn">‚úèÔ∏è Modifier cet objet</a>
        </div>
    </div>

    <div style="margin-top: 20px;">
        <a href="/Objets" class="connect-btn">‚¨Ö Retour √† la liste</a>
    </div>
</div>

</body>
</html>
